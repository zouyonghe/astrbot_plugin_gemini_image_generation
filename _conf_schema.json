{
  "api_settings": {
    "description": "API 设置",
    "type": "object",
    "hint": "配置 API 端点和相关设置",
    "items": {
      "provider_id": {
        "description": "生图模型提供商（必选）",
        "type": "string",
        "hint": "从 AstrBot 提供商列表中选择，插件自动读取模型/密钥/端点；不选将无法调用",
        "_special": "select_provider",
        "default": ""
      },
      "api_type": {
        "description": "API 类型（必选）",
        "type": "string",
        "hint": "必须选择 API 类型（google/openai/zai/grok2api）。选择 zai 时使用 Zai 兼容参数传递；选择 grok2api 时启用图片相对路径/临时缓存兼容",
        "default": "openai",
        "options": [
          "google",
          "openai",
          "zai",
          "grok2api"
        ]
      },
      "model": {
        "description": "模型名称（可选）",
        "type": "string",
        "hint": "如需覆盖 AstrBot 提供商的模型，可在此填写。例如 gemini-3-pro-image-preview 或 OpenAI 兼容模型名。留空使用提供商默认模型",
        "default": ""
      },
      "vision_provider_id": {
        "description": "视觉行列检测提供商（可选）",
        "type": "string",
        "hint": "用于切图前 AI 识别网格行列数，留空则不调用",
        "_special": "select_provider",
        "default": ""
      }
    }
  },
  "image_generation_settings": {
    "description": "图像生成参数",
    "type": "object",
    "hint": "配置图像生成的参数，将根据模型能力自动调整",
    "items": {
      "resolution": {
        "description": "图像分辨率",
        "type": "string",
        "hint": "生成图像的分辨率。不同模型支持的分辨率不同，请参考官方文档",
        "default": "1K",
        "options": [
          "1K",
          "2K",
          "4K"
        ]
      },
      "aspect_ratio": {
        "description": "长宽比",
        "type": "string",
        "hint": "图像的长宽比例。不同模型支持的比例不同，请参考官方文档",
        "default": "1:1",
        "options": [
          "1:1",
          "16:9",
          "4:3",
          "3:2",
          "9:16",
          "4:5",
          "5:4",
          "21:9",
          "3:4",
          "2:3"
        ]
      },
      "enable_sticker_split": {
        "description": "启用表情包切割",
        "type": "bool",
        "hint": "在表情包模式下，自动将生成的一张包含多表情的图片切割成独立的表情图，并以合并转发形式发送",
        "default": true
      },
      "enable_sticker_zip": {
        "description": "启用表情包打包发送",
        "type": "bool",
        "hint": "在启用切割的同时，生成并发送表情包压缩文件(zip)。若发送失败将降级使用合并转发",
        "default": false
      },
      "sticker_grid": {
        "description": "表情包提示词网格",
        "type": "string",
        "hint": "仅影响“表情包”指令生成提示词中的网格描述。格式如 4x4（建议范围 1-20）",
        "default": "4x4"
      },
      "preserve_reference_image_size": {
        "description": "改图保留参考图尺寸",
        "type": "bool",
        "hint": "启用后，改图/换风格等基于参考图的请求将不强制设置分辨率和长宽比，尽量沿用参考图尺寸。",
        "default": false
      },
      "enable_grounding": {
        "description": "启用 Google 搜索接地",
        "type": "bool",
        "hint": "启用后模型可以使用 Google 搜索验证事实并基于实时数据生成图片（如天气、股票、新闻等）。仅 gemini-3-pro-image-preview 模型支持",
        "default": false
      },
      "max_reference_images": {
        "description": "最大参考图片数量",
        "type": "int",
        "hint": "允许使用的最大参考图片数量。不同模型支持的数量不同（Gemini 3: 最多14张，Gemini 2.5: 建议不超过4张）。超出限制的将自动忽略",
        "default": 6
      },
      "enable_text_response": {
        "description": "启用文本响应",
        "type": "bool",
        "hint": "启用后模型将在返回图片的同时返回文本说明。关闭后只返回图片（仅限 gemini 3 有效）",
        "default": false
      },
      "force_resolution": {
        "description": "强制传递分辨率参数",
        "type": "bool",
        "hint": "启用后，无论模型名称是什么，都强制传递 image_size 参数给 API。如果使用非 gemini-3-pro-image-preview 模型但支持分辨率参数，请开启此选项。",
        "default": false
      },
      "resolution_param_name": {
        "description": "分辨率参数名",
        "type": "string",
        "hint": "API 请求中分辨率参数的字段名，不同 API 可能使用不同名称（如 image_size、size、imageSize 等）。留空使用默认值 image_size",
        "default": "image_size"
      },
      "aspect_ratio_param_name": {
        "description": "长宽比参数名",
        "type": "string",
        "hint": "API 请求中长宽比参数的字段名，不同 API 可能使用不同名称（如 aspect_ratio、aspectRatio、image_aspect_ratio 等）。留空使用默认值 aspect_ratio",
        "default": "aspect_ratio"
      },
      "max_inline_image_size_mb": {
        "description": "本地图片 base64 编码阈值（MB）",
        "type": "float",
        "hint": "超过此大小的本地图片将使用文件系统引用而非 base64 编码，减少内存占用。默认 2MB",
        "default": 2.0
      }
    }
  },
  "quick_mode_settings": {
    "description": "快速模式参数覆盖",
    "type": "object",
    "hint": "可选：覆盖“快速”指令各模式的默认分辨率/长宽比；默认值即内置默认，可直接修改。",
    "items": {
      "avatar": {
        "description": "头像模式覆盖",
        "type": "object",
        "hint": "对应命令：快速 头像",
        "items": {
          "resolution": {
            "description": "分辨率（覆盖）",
            "type": "string",
            "hint": "默认即内置默认，可按需修改",
            "default": "1K",
            "options": [
              "1K",
              "2K",
              "4K"
            ]
          },
          "aspect_ratio": {
            "description": "长宽比（覆盖）",
            "type": "string",
            "hint": "默认即内置默认，可按需修改",
            "default": "1:1",
            "options": [
              "1:1",
              "16:9",
              "4:3",
              "3:2",
              "9:16",
              "4:5",
              "5:4",
              "21:9",
              "3:4",
              "2:3"
            ]
          }
        }
      },
      "poster": {
        "description": "海报模式覆盖",
        "type": "object",
        "hint": "对应命令：快速 海报",
        "items": {
          "resolution": {
            "description": "分辨率（覆盖）",
            "type": "string",
            "hint": "默认即内置默认，可按需修改",
            "default": "2K",
            "options": [
              "1K",
              "2K",
              "4K"
            ]
          },
          "aspect_ratio": {
            "description": "长宽比（覆盖）",
            "type": "string",
            "hint": "默认即内置默认，可按需修改",
            "default": "16:9",
            "options": [
              "1:1",
              "16:9",
              "4:3",
              "3:2",
              "9:16",
              "4:5",
              "5:4",
              "21:9",
              "3:4",
              "2:3"
            ]
          }
        }
      },
      "wallpaper": {
        "description": "壁纸模式覆盖",
        "type": "object",
        "hint": "对应命令：快速 壁纸",
        "items": {
          "resolution": {
            "description": "分辨率（覆盖）",
            "type": "string",
            "hint": "默认即内置默认，可按需修改",
            "default": "4K",
            "options": [
              "1K",
              "2K",
              "4K"
            ]
          },
          "aspect_ratio": {
            "description": "长宽比（覆盖）",
            "type": "string",
            "hint": "默认即内置默认，可按需修改",
            "default": "16:9",
            "options": [
              "1:1",
              "16:9",
              "4:3",
              "3:2",
              "9:16",
              "4:5",
              "5:4",
              "21:9",
              "3:4",
              "2:3"
            ]
          }
        }
      },
      "card": {
        "description": "卡片模式覆盖",
        "type": "object",
        "hint": "对应命令：快速 卡片",
        "items": {
          "resolution": {
            "description": "分辨率（覆盖）",
            "type": "string",
            "hint": "默认即内置默认，可按需修改",
            "default": "1K",
            "options": [
              "1K",
              "2K",
              "4K"
            ]
          },
          "aspect_ratio": {
            "description": "长宽比（覆盖）",
            "type": "string",
            "hint": "默认即内置默认，可按需修改",
            "default": "3:2",
            "options": [
              "1:1",
              "16:9",
              "4:3",
              "3:2",
              "9:16",
              "4:5",
              "5:4",
              "21:9",
              "3:4",
              "2:3"
            ]
          }
        }
      },
      "mobile": {
        "description": "手机模式覆盖",
        "type": "object",
        "hint": "对应命令：快速 手机",
        "items": {
          "resolution": {
            "description": "分辨率（覆盖）",
            "type": "string",
            "hint": "默认即内置默认，可按需修改",
            "default": "2K",
            "options": [
              "1K",
              "2K",
              "4K"
            ]
          },
          "aspect_ratio": {
            "description": "长宽比（覆盖）",
            "type": "string",
            "hint": "默认即内置默认，可按需修改",
            "default": "9:16",
            "options": [
              "1:1",
              "16:9",
              "4:3",
              "3:2",
              "9:16",
              "4:5",
              "5:4",
              "21:9",
              "3:4",
              "2:3"
            ]
          }
        }
      },
      "figure": {
        "description": "手办化模式覆盖",
        "type": "object",
        "hint": "对应命令：快速 手办化",
        "items": {
          "resolution": {
            "description": "分辨率（覆盖）",
            "type": "string",
            "hint": "默认即内置默认，可按需修改",
            "default": "2K",
            "options": [
              "1K",
              "2K",
              "4K"
            ]
          },
          "aspect_ratio": {
            "description": "长宽比（覆盖）",
            "type": "string",
            "hint": "默认即内置默认，可按需修改",
            "default": "3:2",
            "options": [
              "1:1",
              "16:9",
              "4:3",
              "3:2",
              "9:16",
              "4:5",
              "5:4",
              "21:9",
              "3:4",
              "2:3"
            ]
          }
        }
      }
    }
  },
  "retry_settings": {
    "description": "重试设置",
    "type": "object",
    "hint": "配置 API 调用失败时的重试策略",
    "items": {
      "max_attempts_per_key": {
        "description": "每个 API 密钥的最大重试次数",
        "type": "int",
        "hint": "当 API 请求失败时，每个密钥最多重试几次。设置为1表示不重试，直接切换密钥。推荐2-5次",
        "default": 3
      },
      "enable_smart_retry": {
        "description": "启用智能重试（区分错误类型）",
        "type": "bool",
        "hint": "启用后会对不同错误类型采用不同策略：额度/速率限制直接切换密钥，网络错误进行重试",
        "default": true
      },
      "total_timeout": {
        "description": "总超时时间",
        "type": "int",
        "hint": "单次 API 调用的总超时时间（秒）。建议根据网络状况和服务质量调整，过短可能导致频繁超时",
        "default": 120
      }
    }
  },
  "service_settings": {
    "description": "服务设置",
    "type": "object",
    "hint": "配置文件传输等外部服务",
    "items": {
      "nap_server_address": {
        "description": "NAP cat 服务地址",
        "type": "string",
        "hint": "仅当 NAP 和机器人不在同一服务器时填写，同服务器填写 localhost",
        "default": "localhost"
      },
      "nap_server_port": {
        "description": "文件传输端口",
        "type": "int",
        "hint": "NAP cat 所在服务器接收文件端口，在同一服务器上可以不填",
        "default": 3658
      },
      "auto_avatar_reference": {
        "description": "自动头像参考",
        "type": "bool",
        "hint": "启用后，当消息包含头像相关关键词时，自动获取群头像和用户头像作为参考图像。仅支持 NapCat 平台",
        "default": false
      },
      "theme_settings": {
        "description": "主题设置",
        "type": "object",
        "hint": "配置帮助页面的主题切换模式",
        "items": {
          "mode": {
            "description": "切换模式",
            "type": "string",
            "hint": "选择主题加载模式。Cycle: 循环模式（随时间切换）；Single: 单独模式（固定使用一个）。",
            "default": "cycle",
            "options": [
              "cycle",
              "single"
            ]
          },
          "cycle_config": {
            "description": "循环模式配置",
            "type": "object",
            "hint": "仅在 cycle 模式下生效",
            "items": {
              "day_start": {
                "description": "白天开始时间",
                "type": "int",
                "hint": "选择白天开始的小时数（0-23点）",
                "default": 6,
                "options": [
                  0,
                  1,
                  2,
                  3,
                  4,
                  5,
                  6,
                  7,
                  8,
                  9,
                  10,
                  11,
                  12,
                  13,
                  14,
                  15,
                  16,
                  17,
                  18,
                  19,
                  20,
                  21,
                  22,
                  23
                ]
              },
              "day_end": {
                "description": "白天结束时间",
                "type": "int",
                "hint": "选择白天结束的小时数（0-23点）",
                "default": 18,
                "options": [
                  0,
                  1,
                  2,
                  3,
                  4,
                  5,
                  6,
                  7,
                  8,
                  9,
                  10,
                  11,
                  12,
                  13,
                  14,
                  15,
                  16,
                  17,
                  18,
                  19,
                  20,
                  21,
                  22,
                  23
                ]
              },
              "day_template": {
                "description": "白天模板文件",
                "type": "string",
                "hint": "白天使用的模板文件名（位于 templates/ 目录下）",
                "default": "help_template_light"
              },
              "night_template": {
                "description": "黑夜模板文件",
                "type": "string",
                "hint": "黑夜使用的模板文件名（位于 templates/ 目录下）",
                "default": "help_template_dark"
              }
            }
          },
          "single_config": {
            "description": "单独模式配置",
            "type": "object",
            "hint": "仅在 single 模式下生效",
            "items": {
              "template_name": {
                "description": "模板文件名",
                "type": "string",
                "hint": "要固定的模板文件名（位于 templates/ 目录下）",
                "default": "help_template_light"
              }
            }
          }
        }
      }
    }
  },
  "help_render_mode": {
    "description": "帮助页渲染模式",
    "type": "string",
    "hint": "html: 使用 t2i 网络服务渲染 HTML；local: 本地 Pillow 渲染 Markdown（无需浏览器）；text: 纯文本",
    "default": "html",
    "options": [
      "html",
      "local",
      "text"
    ]
  },
  "html_render_options": {
    "description": "HTML 渲染截图选项",
    "type": "object",
    "hint": "用于 html_render 渲染帮助页时的截图配置（仅 html 模式生效）",
    "items": {
      "quality": {
        "description": "截图质量（1-100）",
        "type": "int",
        "hint": "留空使用 AstrBot 默认值",
        "default": null
      },
      "type": {
        "description": "截图格式",
        "type": "string",
        "hint": "png 或 jpeg。若选择 jpeg，quality 生效；png 质量固定但体积更大",
        "default": "png",
        "options": [
          "png",
          "jpeg"
        ]
      },
      "scale": {
        "description": "截图缩放方式",
        "type": "string",
        "hint": "device 使用设备像素（更清晰，文件更大），css 使用 CSS 像素（更小更快）",
        "default": "device",
        "options": [
          "css",
          "device"
        ]
      },
      "full_page": {
        "description": "截取整页",
        "type": "bool",
        "hint": "true 截整页，false 仅视口",
        "default": true
      },
      "omit_background": {
        "description": "去除背景",
        "type": "bool",
        "hint": "仅 png 有效，设置为 true 可生成透明背景",
        "default": false
      }
    }
  },
  "limit_settings": {
    "description": "限制/限流设置",
    "type": "object",
    "hint": "配置群聊限制模式（不限/白名单/黑名单）以及单群限流策略，用于控制在哪些群可以使用生图功能，以及单个群在一个周期内的最大调用次数",
    "items": {
      "group_limit_mode": {
        "description": "群限制模式",
        "type": "string",
        "hint": "选择对群聊的限制策略：None 表示不限制；Whitelist 仅允许列表中的群使用；Blacklist 禁止列表中的群使用。",
        "default": "none",
        "options": [
          "none",
          "whitelist",
          "blacklist"
        ]
      },
      "group_limit_list": {
        "description": "群号列表",
        "type": "list",
        "hint": "根据上方的群限制模式配置需要生效的群号。群号请填写字符串形式，在 None 模式下此配置不生效。",
        "default": []
      },
      "enable_rate_limit": {
        "description": "启用群内限流",
        "type": "bool",
        "hint": "开启后会对每个群在指定周期内的图像生成/改图请求次数进行限制",
        "default": false
      },
      "rate_limit_period": {
        "description": "限流周期（秒）",
        "type": "int",
        "hint": "每个群的统计周期长度（单位：秒），在此时间窗口内超过最大次数将被拒绝",
        "default": 60
      },
      "max_requests_per_group": {
        "description": "单群每周期最大请求数",
        "type": "int",
        "hint": "在一个周期内，每个群最多允许触发几次图像生成/改图/风格转换等请求。",
        "default": 5
      }
    }
  },
  "cache_settings": {
    "description": "缓存设置",
    "type": "object",
    "hint": "配置图片缓存清理策略，包括缓存保留时间和清理周期",
    "items": {
      "cache_ttl_minutes": {
        "description": "缓存保留时间（分钟）",
        "type": "int",
        "hint": "生成的图片、下载缓存、切图等文件保留多少分钟后自动清理，设为 0 表示不自动清理",
        "default": 5
      },
      "cleanup_interval_minutes": {
        "description": "清理间隔（分钟）",
        "type": "int",
        "hint": "定时清理任务的执行间隔，设为 0 表示禁用定时清理",
        "default": 30
      },
      "max_cache_files": {
        "description": "缓存文件数量上限",
        "type": "int",
        "hint": "各缓存目录的文件数量上限，超过时会按时间清理最旧的文件，设为 0 表示不限制数量",
        "default": 100
      }
    }
  }
}
